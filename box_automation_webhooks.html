<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>BOX Cloud Upload automation from On-prem</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
  <main class="content fade-in">
    <h1>üöÄ Automating File Routing in Box with AWS Lambda & Webhooks</h1>
    <p><em>Business Applications Specialist (Technical Product Manager) - Doctors of BC | 2025 </em></p>
    <p>
      <a href="https://github.com/mranna/Automating-BOX-Cloud-Uploads-from-On-Prem" target="_blank" title="GitHub Repo">
        <i class="fab fa-github"></i> GitHub
    </a>
    </p>
    <h2>Problem Statement</h2>
    <p>
      Box Relay is a powerful workflow automation tool for many content-centric processes. However, one of its limitations is that it doesn‚Äôt support routing files to folders based on custom metadata values.
      For example, you might want all uploaded invoices tagged with company1=1 to go into a dedicated folder for Company 1, and those tagged with company1=2 into Company 2‚Äôs folder. Relay cannot directly express this routing logic, especially when combined with complex metadata validation.
      The result?
      <ul>
        <li>Manual file moves by end users.</li>
        <li>Error-prone processes that break compliance rules.</li>
        <li>Increased administrative burden and cost.</li>
      </ul>
    </p>
    <h2>Solution</h2>
    <p>
     By leveraging AWS Lambda and Box Webhooks, we can create a lightweight, scalable solution to automatically route files as soon as they land in an intake folder. The flow looks like this:
    <ul>
      <li>A file is uploaded into the intake folder in Box.</li>
      <li>Box fires a FILE.UPLOADED webhook.</li>
      <li>AWS Lambda receives the event, fetches the file metadata, and applies routing logic.</li>
      <li>Based on metadata values (e.g., company ID, region, department), the Lambda moves the file to the correct destination folder.</li>
    </ul>
    <p>This approach is:</p>
      <li>Flexible ‚Äì Any logic supported in code can be applied (metadata validation, error handling, default routes).</li>
      <li>Efficient ‚Äì Uses a cached OAuth2 token, parallel Box API calls, and avoids unnecessary moves.</li>
      <li>Secure ‚Äì With webhook signature validation and environment-based folder mappings.</li>
    </p>

    <h2>Architecture Overview</h2>
<pre>

</pre>


    <h2>Tech Stack</h2>
    <ul>
      <li>AWS Lambda (Node.js 18+) ‚Äì Event-driven serverless function.</li>
      <li>Box Webhooks ‚Äì Event notification mechanism on file activity.</li>
      <li>Box Content & Metadata API ‚Äì To fetch file details, metadata, and perform moves.</li>
      <li>AWS API Gateway (optional) ‚Äì For routing and securing webhook calls.</li>
      <li>AWS CloudWatch ‚Äì For structured logging, error monitoring, and metrics.</li>
    </ul>

    <h2>Possible Applications</h2>
    <ul>
      <li>Multi-Company Intake ‚Äì Shared service centers where incoming documents must be separated by client or legal entity.</li>
      <li>Departmental Workflows ‚Äì HR, Finance, and Legal documents automatically routed to correct departmental repositories.</li>
      <li>Records Management ‚Äì Apply retention categories via metadata and route to correct lifecycle folders.</li>
      <li>Global Operations ‚Äì Region-based folder routing to enforce data residency (e.g., EU vs. US storage).</li>
      <li>Customer Onboarding ‚Äì Automatically placing uploaded contracts, IDs, and forms into customer-specific folders.</li>
    </ul>

    <p><a href="index.html">‚Üê Back to Home</a></p>
  </main>
</body>
</html>
